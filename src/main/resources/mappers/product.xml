<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.parker.user.dao.ProductMapper">
	<!-- 상품 전체목록 -->
	<select id="productList" parameterType="com.parker.user.vo.ProductVO"
		resultType="com.parker.user.vo.ProductVO">
		<!-- SELECT
		product_number AS productId,
		product_name AS productName,
		product_price AS productPrice,
		product_content AS productContent,
		product_image AS productImage,
		product_company AS productCompany,
		product_origin AS productOrigin
		FROM products_tb
		ORDER BY product_name -->
		
		SELECT *
		from(select lst.*, rownum as rnum
		from(
		select
		product_number AS productId,
		product_name AS productName,
		product_price AS productPrice,
		product_content AS productContent,
		product_image AS productImage,
		product_company AS productCompany,
		product_origin AS productOrigin
		FROM products_tb
		ORDER BY product_name asc
		)lst
		)
		
		
		<!-- select *
		from(select lst.*, rownum as rnum
		from(
		select
		question_number,
		question_title,
		question_writedate,question_content,question_viewCount,
		u.user_name
		from
		question_tb,
		users_tb u
		where question_tb.user_number= u.user_number
		order by
		question_number asc
		)lst
		) -->
		
		<where>
			<if test="start_row != null and start_row != ''">
				<if test="end_row != null and end_row != ''">
					rnum between #{start_row} and #{end_row}
				</if>
			</if>
		</where>
		
	</select>
	
	<!-- 전체 레코드 건수 -->
	<select id="productListCnt" parameterType="com.parker.user.vo.ProductVO" resultType="int">
		select NVL(count(1), 0) 
		from(select lst.*, rownum as rnum
		 from(
		 	select 
		 	product_number AS productId,
		product_name AS productName,
		product_price AS productPrice,
		product_content AS productContent,
		product_image AS productImage,
		product_company AS productCompany,
		product_origin AS productOrigin
		from products_tb
	<!-- 	<trim prefix="WHERE" prefixOverrides="AND">
		<if test="search == 'product_name'">
			<![CDATA[product_name LIKE '%'|| #{keyword} || '%']]>
		</if>
		<if test= "search == 'product_price'">
			<![CDATA[ AND product_price LIKE '%' || #{keyword} || '%']]>
		</if>
		
		</trim> -->
		ORDER BY product_number desc
		 )lst
		)
	</select>

	<!-- 상품 상세보기 -->
	<select id="productDetail" parameterType="com.parker.user.vo.ProductVO"
		resultType="com.parker.user.vo.ProductVO">
		SELECT
		product_number AS productId,
		product_name AS productName,
		product_price AS productPrice,
		product_content AS productContent,
		product_image AS productImage,
		product_company AS productCompany,
		product_origin AS productOrigin,
		product_regdate AS productRegdate
		FROM products_tb
		WHERE product_number = #{productId}
	</select>
</mapper>
